<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Understanding quantum effects &mdash; PIMC++ 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PIMC++ 1.0.0 documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="index.html">PIMC++ 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <p><strong>Liquid Helium Tutorial</strong></p>
<p>In this tutorial, we will estimate the transition temperature between
normal liquid Helium and superfluid liquid Helium at saturated vapor
pressure (SVP). To estimate the superfluid transition temperature, we
need to scan over a range of temperatures to identify the critical
point.</p>
<p><strong>Warning:</strong> Due to time constraints in this tutorial, our calculation
will use a small number of particles (10) and a correspondingly small
simulation box. Consequently, we will be violating the rule that
short-range pair interactions must be zero beyond half the box length
(they should be truncated and tapered to ensure a smooth potential
energy surface). In other words, our simulation box is smaller than the
length scale of the particle pair interactions, which introduces
discontinuities into the potential energy surface. Thus, this system is
too small to give accurate results and is intended as a pedagogical
example only.</p>
<p>You are encouraged to prepare your own input file for these simulations
by converting the single particle input file we just used. By doing so,
you will learn a lot about the capabilities and the options of the code.
Instructions for doing this are contained
<a class="reference external" href="WritingHeliumInputfile">here</a>. However, this process will be
time-consuming for first-time users, so we will provide the relevant
input files below so you can get started with the runs right away. If
you choose to move on and use the prepared input files for your runs,
you should come back and review <a class="reference external" href="WritingHeliumInputfile">the detailed
instructions</a> at the end.</p>
<div class="section" id="understanding-quantum-effects">
<h1>Understanding quantum effects<a class="headerlink" href="#understanding-quantum-effects" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will explore the nature of quantum effects and how
they are manifested in PIMC simulations. As we lower the temperature of
Helium-4, we will see a transition from particles that are effectively
classical, to particles where quantum zero point motion becomes
important, and finally to particles where bosonic exchange statistics
become important.</p>
<p>We will start with the input file contained here:
<a class="reference external" href="Helium_File_2">Helium.in</a>. If you generated your own input, compare
it against this example to check for typos. You also need
He4.95.OffDiag.dm, He4.95.Sampling.in and He4.95.PairAction; copies of
these files are in a location that the setup_PIMC script will find so
you don&#8217;t need to worry about them if you are running on a lab machine.</p>
<p>Now, we want to start with liquid helium in the high temperature regime.
We will start by examining a temperature of 64K. For this temperature we
will use tau=0.0015625 with NumTimeSlices=10. To prepare this run, open
the input file for editing and change tau (Section: System) and
NumTimeSlices (Section: System) appropriately. Run pimc++ with</p>
<div class="highlight-python"><pre>pimc++ Helium.in</pre>
</div>
<p>This takes some time. You may want to look over how to write the <a class="reference external" href="WritingHeliumInputfile">file
input</a> file, generate the <a class="reference external" href="Constructingadensitymatrix">pair density
matrix</a>, or how you can<a class="reference external" href="BosonPicture">explicitly
integrate over permutations</a>.</p>
<p>Now that the simulation has completed, we can analyze its results. To do
this, run the report generator (Report.py) on the h5 file that it
produced and examine the output with your web browser. As before, you
can use firefox or konqueror to view this output. It should look very
similar to
<a class="reference external" href="http://esler.physics.uiuc.edu/tutorial/liquidHelium/Helium64/">this.</a></p>
<p>Notice that not only is there information about the energy but we also
see the structure factor, superfluid fraction, and pair correlation
function. Looking at the structure factor, we can see that the system we
are simulating is a liquid (the structure factor of a solid would have a
noticeable peak.) The value of <span class="math">\(\frac{\rho_s}{\rho}\)</span> is 0
indicating that the system is not superfluid. From the pair correlation,
we can notice a couple things. To begin with, we clearly see that Helium
has a hard core (there are effectively no particles within a distance of
2). We also can tell that the well of the inter-particle potential is
approximately where the peak of the pair correlation function is shown.</p>
<p>The analysis should give a summary of all the observables except the
PathDump. The PathDump observable dumps complete configurations of the
path so that one can look at visual images of them. This will allow us
to get physical intuition about how quantum effects become important. On
the lab machines, we will use the pathvis++ tool set up by the
<tt class="docutils literal"><span class="pre">setup_pimc++</span></tt> script. Type</p>
<div class="highlight-python"><pre>pathvis++ Helium.0.h5</pre>
</div>
<div class="line-block">
<div class="line">We now see a screen like this:</div>
</div>
<center><p><sup>4</sup>He at 64 K</p>
<p>Image:Helium.64.png</p>
</center><p>The simulation box can be rotated by left-clicking and dragging the
mouse. You may zoom with the scroll wheel or by middle-clicking and
dragging left (zoom out) or right (zoom in). At the bottom of the screen
is a slider that allows us to change through frames of each successive
Monte Carlo step that was dumped to the output file. You should notice
here that the particle paths are are much smaller than the
inter-particle spacing. This compactness essentially indicates that at
all points through imaginary time, the particle is in nearly the same
place. In this regime, the helium atoms would be reasonably well
approximated by treating them as classical particles.</p>
<div class="line-block">
<div class="line">Let&#8217;s now lower the temperature and see what happens when quantum</div>
</div>
<p>effects become important. We will lower the temperature to approximately
4.2 K. Change tau (Section: System) to 0.0125 and find an appropriate
value to change NumTimeSlices (Section: System) to in order to get the
desired temperature. (Caveat: Typically, we wouldn&#8217;t change tau
significantly during a study because the time step error would change
but we are doing it for the tutorial to keep the number of time slices
small for different temperatures). Now, run your simulation and again
view the simulation using pathvis++. You should find paths much like
this:</p>
  <center>

\ :sup:`4`\ He at 4.2 K<p>Image:Helium_4.2.png</p>
</center><p>Notice that these paths are significantly larger than the paths at 64 K.
Their non-negligible extent is a manifestation of zero point motion. In
this regime, the system would be poorly represented by a classical
potential (which &#8220;point&#8221; in space along the path would you even use to
represent the classical particle?). There are many simulations in which
zero point motion is important (for example ambient water), even though
exchange statistics aren&#8217;t critical. You can tell that statistics aren&#8217;t
relevant in this simulation because the paths aren&#8217;t permuting onto each
other. The inter-particle separation is sufficiently large that a
permutation would be very unfavorable in terms of the energetics of the
springs. Notice that in the simulations at both 6 K and 64 K, the
winding number is 0.</p>
<div class="line-block">
<div class="line">Now, let&#8217;s run a simulation where the bosonic nature of Helium is</div>
</div>
<p>important. Set the temperature to 2.0K (let tau be 0.025). Run this
simulation and view the results using pathvis++. As you push the slider
and advance through Monte Carlo steps we see the paths in our system
expand and begin to permute onto each other. The existence of permuted
paths indicates the importance of boson exchange statistics in this
simulation. At some point, you will see a series of permuting paths wind
across the entire box (to see this, it is sometimes helpful to toggle to
Wrap mode with the button at top. This forces the paths to stay within
the box whereas the other mode tries to enforce continuity of the
paths). This wrapping around the box is an indication that the system is
superfluid. See mathematically how <a class="reference external" href="PathIntegralSuperfluidity">superfluidity manifests itself
within Path Integral Monte Carlo</a>.
Winding paths are indicated in yellow. Of course, the jumping around of
these paths sometimes obfuscates their global structure which makes it
hard to see what&#8217;s going on. If we click &#8220;Smooth&#8221;, these paths will be
smoothed by truncating their Fourier spectrum. The &#8220;Detail&#8221; slider
controls how many Fourier components are retained, i.e. you can adjust
this slider to tune the desired amount of detail in the path. Finally,
once you have a configuration and perspective you like, you can click on
tubes to add depth cues to the paths. At this point, you should have a
visualization similar to</p>
<center><p><sup>4</sup>He at 1 K</p>
<p>Image:Helium_1K.png</p>
</center><p>In summary, we see that as the temperature decreases, quantum effects
become increasingly important, specifically zero point motion and then
quantum statistics.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="34%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference external" href="Image:Helium.64.png">thumb|left|225px| 64 K</a></td>
<td><a class="reference external" href="Image:Helium_4.2.png">thumb|left|225px| 4.2 K</a></td>
<td><a class="reference external" href="Image:Helium_1K.png">thumb|left|225px| 1 K</a></td>
</tr>
</tbody>
</table>
<p>Table: <strong>Summary</strong></p>
<p>Before we move on, we should make sure we are using simulation
parameters (time step and system size) that lead to a well-converged
result (i.e. introduce negligible systematic errors). We will also want
to tune the algorithm (i.e., you may notice that you are spending too
much time computing observables and not enough time actually performing
the Monte Carlo moves of the simulation).</p>
<ol class="arabic simple">
<li><a class="reference external" href="CheckingConvergence(LiquidHeliumTutorial)">Checking
Convergence</a></li>
<li><a class="reference external" href="AlgorithmTuning(LiquidHeliumTutorial)">Algorithm Tuning</a></li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">Of course, as we change other parameters, we would want to re-optimize</div>
</div>
<p>these settings. However, an initial adjustment is adequate for our
purposes.</p>
</div>
<div class="section" id="superfluid-transition">
<h1>Superfluid Transition<a class="headerlink" href="#superfluid-transition" title="Permalink to this headline">¶</a></h1>
<p>Let us now proceed to calculate the superfluid transition temperature of
liquid helium. We can start to get a rough estimate of this value by
measuring the superfluid fraction at a variety of different
temperatures. Let us do a series of calculations from
<span class="math">\(1.0 - 3.0 K\)</span>. The temperature is set as <span class="math">\(1/\beta\)</span> where
<span class="math">\(\beta\)</span> is set by the product of the input variables tau (Section:
System) and NumTimeSlices (Section: System). Let&#8217;s make sure our time
step <span class="math">\(\tau\)</span> is 0.025.</p>
<p>There is a only a discrete set of temperatures (in our relevant
temperature range) we can choose because <span class="math">\(\beta\)</span> must be an
integral multiple of tau, whose values are constrained by the density
matrix files that were generated. Set up 5 different simulations in this
temperature range (by changing the NumTimeSlices (Section: System)
variable and see if you can locate the Superfluid transition (remember,
you will also need to change the name for the OutFileBase (Section:
Observables) if you want it to write different output files). Once these
runs have completed, use the python analysis script Report.py to examine
them</p>
<div class="highlight-python"><pre>Report.py theFileName</pre>
</div>
<div class="line-block">
<div class="line">and then plot the Superfluid Fraction as a function of temperature. (5</div>
</div>
<p>minute runs should be sufficient to get a rough outline of the graph
especially at higher temperature). A reasonably converged graph should
look like this (the red points are from the PIMC++ simulation. The green
lines are experimental results from Donnelly, 1967):
| Image:SuperfluidGraph_10ptcl_longerRun.png
| An example of what you may see after 5 minutes is
<a class="reference external" href="SuperfluidGraph_10ptcl">here</a></p>
<p>Although we know that this transition must be sharp in the thermodynamic
limit (<span class="math">\(N \rightarrow \infty, N/V\)</span> constant), it appears very
smooth and not at any definitive temperature in our graph. At best we
can only qualitatively locate the transition temperature. This is
because 10 particles is very far from the thermodynamic limit. (Remember
that phase transitions are only formally defined in the thermodynamic
limit) We could obviously mitigate these finite size effects by going to
a system of more than 10 particles (and we will do so in a moment). (An
even better method is to do a variety of system sizes and then use a
finite size scaling analysis to pinpoint the exact transition
temperature, but an explanation of how this works is beyond the scope of
the tutorial.) Before we embark on these larger systems, though, it
behooves us understand how to use parallelization with PIMC++.</p>
<p>Because we want to calculate the superfluid fraction as quickly as
possible, we will want to take advantage of different modes of
parallelization within PIMC++. The code supports two modes of
parallelism: cloning and time slice parallization.</p>
<div class="section" id="cloning-parallelization">
<h2>Cloning Parallelization<a class="headerlink" href="#cloning-parallelization" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>We will skip this section of the tutorial, since the computer lab is</div></blockquote>
<p>not set up with a parallel run environment. You can skip to the next
<a class="reference external" href="Bulkhelium#Superfluid_Transition_Temperature_Calculation_(larger_system)">Section</a>.
You can read on if you are interested in parallelization in PIMC++.
However, the lab is not set up to run PIMC++ in parallel.</p>
<div class="line-block">
<div class="line">The first mode of parallelism is to run many independent copies of the</div>
</div>
<p>simulation. Because the error bars of our simulation depend on the
number of independent samples we collect, Monte Carlo is &#8220;trivially
parallel&#8221; in this sense. PIMC++ automatically takes advantage of this
form of parallelism as its <em>default</em> behavior. If you run the code
(using mpirun or the equivalent for your MPI implementation) on more
than one processor, it will run independently on each processor,
creating output files labeled basename.PROCNUMBER.h5. Let&#8217;s see this now
by running PIMC++ on multiple processors. For a preconfigured system
(these machines aren&#8217;t), you can run</p>
<div class="highlight-python"><pre>runPIMC Helium.in -np 4</pre>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line-block">
<div class="line">Once the run is complete, you should see Helium.0.h5, Helium.1.h5,</div>
</div>
</div>
<p>Helium.2.h5 and Helium.3.h5. Running the python analysis script</p>
<div class="highlight-python"><pre>Report.py Helium</pre>
</div>
<p>will analyze all 4 of these files simultaneously. You should see that
the simulation has error bars that are approximately half as large as
they were earlier.</p>
</div>
<div class="section" id="time-slice-parallelization">
<h2>Time slice Parallelization<a class="headerlink" href="#time-slice-parallelization" title="Permalink to this headline">¶</a></h2>
<p>We will also skip this section, since the computer lab is not set up
with a parallel environment.</p>
<p>In discussing time slice parallelization, we will refer to two important
quantities. <span class="math">\(NP\)</span> refers to the number of processors allocated to
PIMC++ at runtime. For example, if we had used the generic MPI command
%mpirun -np 4 pimc++ myInput.in or the Tungsten script %runPIMC
nyInput.in -np 4, NP would be 4. The other important quantity is
ProcsPerClone, specified in the PIMC++ input file. For the Cloning mode
of parallelization discussed in the previous section, ProcsPerClone=1.</p>
<p>Unfortunately, for very large systems, the trivial (or natural!)
parallelization of Monte Carlo may not be enough. This is because the
amount of wall clock time it takes for the system to come into
equilibrium may become very large. In this case, we can also parallelize
over the time slices. In this case, the path of M slices is divided
between n processors (i.e. processor 0 can be in charge of slices 0-20,
processor 1 can be in charge of slices 20-40, processor 2 in charge of
40-60, etc.). The two modes of parallelism can be combined.</p>
<p>Effective use of time slice parallelism can make one&#8217;s wallclock running
time largely independent of temperature. We can utilize this mode of
parallelism by editing the Section:Parallel of our input file. The
relevant variable, ProcsPerClone, sets how many processors are used for
each independent copy of the simulation. The time slices will then be
distributed evenly over these processors. To choose the correct number
of processors, we should keep the following considerations in mind. To
begin with, it is a rule that each processor must have at least
<span class="math">\(2^l\)</span> slices where l is the maximum level that is used in any
Bisection Move throughout the simulation. On the other hand, you don&#8217;t
want to have too many slices per processor or we won&#8217;t gain as much a
speedup as desired. Also, the total number of processors must be a
multiple of ProcsPerClone. If <span class="math">\(NP \neq ProcsPerClone\)</span>, PIMC++ will
run <span class="math">\(\frac{NP}{ProcsPerClone}\)</span> clones, each of which has
ProcsPerClone processors assigned to it, thereby using both methods of
parallelism in the same simulation. When <span class="math">\(NP=ProcsPerClone\)</span>, a run
will produce only one output file that looks as if the simulation had
been run in series.</p>
<p>Let&#8217;s now experiment with these modes of parallelism. We will do a
system of 10 time slices split over 2 processors so each processor has 5
slices (practically you would more likely do 500 slices spread over 25
processors so each processor had 20 slices). Set <em>ProcsPerClone</em>
(Section:Parallel) equal to 2 instead of 1 and the <em>NumTimeSlices</em>
(Section: System) variable to 10. Now, run your job on 2 processors. On
Tungsten,</p>
<div class="highlight-python"><pre>runPIMC Helium.in -np 2</pre>
</div>
<p>You&#8217;ll notice that it produces a single output file. Run the analysis on
this output file and examine it. If you had run this same temperature
earlier, you should notice your error bars are approximately a factor of
<span class="math">\(\sqrt{2}\)</span> smaller than they were previously.</p>
</div>
</div>
<div class="section" id="superfluid-transition-temperature-calculation-larger-system">
<h1>Superfluid Transition Temperature Calculation (larger system)<a class="headerlink" href="#superfluid-transition-temperature-calculation-larger-system" title="Permalink to this headline">¶</a></h1>
<p>We will now try to pin down the superfluid transition temperature more
accurately by doing a larger system. In the winter school, we will do
this in a group setting (if you are following this tutorial yourself,
acquiring all the data will involve performing several longer runs). We
will do a system of 32 particles and again try to find the transition
temperature. With 32 particles, the size of the box is now
<span class="math">\(11.361397~\AA\)</span> for the same saturated vapor pressure density.
Everyone should make sure they make the changes:</p>
<ul class="simple">
<li><em>NumParticles</em> (Section:System/Particles/Species) to 32 and</li>
<li><em>Box</em> (Section:System) to [11.361397, 11.361397, 11.361397]</li>
</ul>
<p>Now, choose a temperature in the range from 1-3K (preferably something
different from your neighbor) and adjust <em>NumTimeSlices</em> (Section:
System) to reflect that.</p>
<p>Now, everyone should run their simulation using</p>
<div class="highlight-python"><pre>pimc++ Helium.in</pre>
</div>
<p>As it is progressing, run your analysis script (Report.py) to make sure
it looks like it is producing reasonable data. We will collect these
numbers on the board and try to better locate the transition
temperature.</p>
<p>Continue now to <a class="reference external" href="http://cms.mcc.uiuc.edu/pimcpp/index.php/H2">H2
molecule</a></p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Understanding quantum effects</a></li>
<li><a class="reference internal" href="#superfluid-transition">Superfluid Transition</a><ul>
<li><a class="reference internal" href="#cloning-parallelization">Cloning Parallelization</a></li>
<li><a class="reference internal" href="#time-slice-parallelization">Time slice Parallelization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#superfluid-transition-temperature-calculation-larger-system">Superfluid Transition Temperature Calculation (larger system)</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/Bulk-helium.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="index.html">PIMC++ 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Ken Esler, Bryan Clark, Ethan Brown.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>